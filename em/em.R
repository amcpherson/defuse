
k=3
n=200
u=137
s=21
l=0.1

minW=0.0001
tol=0.0001

# random selection of breakpoints B
B = matrix(round(runif(k*2,0,1000)), nrow=k)

# mixing weights W
while (T)
{
	W = runif(k,0,1); 
	W = W / sum(W);
	if (all(W > 1/(4*k)))
	{
		break;
	}
}

# create n simulated fragments
Z = rmultinom(n, 1, W)

# generate fragment lengths
lengths = as.integer(rnorm(n, u, s))

# generate breakpoint offsets
offsets = as.integer(runif(n, 0, 1) * lengths)

# generate positions
X = colSums(B[,1] * Z) - offsets
Y = colSums(B[,2] * Z) - (lengths - offsets)
plot(X,Y)


max0 <- function(X)
{
	X[X<0] = 0
	return(X)
}

pe_prob <- function(X, Y, b, u, s, l)
{
	return(exp(-0.5 * ((b[1]+b[2] - X - Y - u) / s)^2 - l * max0(X - b[1]) - l * max0(Y - b[2])))
}

pe_resp_log_likelihood <- function(X, Y, r, b, u, s, l)
{
	return(sum(r * (-0.5 * ((b[1]+b[2] - X - Y - u) / s)^2 - l * max0(X - b[1]) - l * max0(Y - b[2]))))
}

pe_exp <- function(X, Y, b, u, s, l)
{
	return(-1/2 * ((b[1]+b[2]-X-Y-u) / s)^2 - l*max0(X-b[1]) - l*max0(Y-b[2]) )
}

pe_resp <- function(X, Y, B, W, u, s, l)
{
	exponents = matrix(0, length(X), dim(B)[1])
	for (i in 1:dim(B)[1])
	{
		exponents[,i] = -0.5 * ((B[i,1]+B[i,2]-X-Y-u) / s)^2 - l*max0(X-B[i,1]) - l*max0(Y-B[i,2])
	}
	maxexp = apply(exponents, 1, function(x) max(x) )
	resp = matrix(0, length(X), dim(B)[1])
	for (i in 1:dim(B)[1])
	{
		resp[,i] = W[i] * exp(exponents[,i] - maxexp) / rowSums(rep(W,each=length(X)) * exp(exponents - maxexp))
	}
	return(resp)
}

pe_likelihood <- function(X, Y, B, W, u, s, l)
{
	ll = 0
	ls = c()
	for (n in 1:length(X))
	{
		sum = 0
		for (k in 1:dim(B)[1])
		{
			sum = sum + W[k] * pe_prob(X[n], Y[n], B[k,], u, s, l)
		}
		ll = ll + log(sum)
		ls = c(ls,sum)
	}
	
	if (is.infinite(ll))
	{
		ll = -1e100
	}
	
	return(ll)
}

pe_max_likelihood <- function(X, Y, r, u, s, l)
{
	Xord = cbind(X,r)[order(X,decreasing=T),]
	Yord = cbind(Y,r)[order(Y,decreasing=T),]
	
	Xsum = cbind(Xord,cumsum(Xord[,2]));
	Ysum = cbind(Yord,cumsum(Yord[,2]));
	
	i = 1
	j = 1
	Xcorner = c(Xsum[1,1])
	Ycorner = c(Ysum[1,1])
	Sum = c(0)
	while (i <= dim(Xord)[1] && j <= dim(Xord)[1])
	{
		while (i < dim(Xord)[1] && Xsum[i,1] == Xsum[i+1,1])
		{
			i = i+1
		}
		
		while (j < dim(Yord)[1] && Ysum[j,1] == Ysum[j+1,1])
		{
			j = j+1
		}
		
		if (abs(Xsum[i,3] - Ysum[j,3]) < 1e-150)
		{
			SAVG = 0.5*(Xsum[i,3]+Ysum[j,3]);

			Xcorner = c(Xcorner, Xsum[i,1])
			Ycorner = c(Ycorner, Ysum[j,1])
			Sum = c(Sum, SAVG)
			
			if (i < dim(Xord)[1] && j < dim(Yord)[1]) {
				Xcorner = c(Xcorner, Xsum[i+1,1])
				Ycorner = c(Ycorner, Ysum[j+1,1])
				Sum = c(Sum, SAVG)
			}
			
			i = i+1;
			j = j+1;
		} 
		else if (Xsum[i,3] < Ysum[j,3]) {
			Xcorner = c(Xcorner, Xsum[i,1])
			Ycorner = c(Ycorner, Ysum[j,1])
			Sum = c(Sum, Xsum[i,3])
			if (i < dim(Xord)[1]) {
				Xcorner = c(Xcorner, Xsum[i+1,1])
				Ycorner = c(Ycorner, Ysum[j,1])
				Sum = c(Sum, Xsum[i,3])
			}
			i = i + 1
		} else {
			Xcorner = c(Xcorner, Xsum[i,1])
			Ycorner = c(Ycorner, Ysum[j,1])
			Sum = c(Sum, Ysum[j,3])
			if (j < dim(Xord)[1]) {
				Xcorner = c(Xcorner, Xsum[i,1])
				Ycorner = c(Ycorner, Ysum[j+1,1])
				Sum = c(Sum, Ysum[j,3])
			}
			j = j + 1
		}
	}
	
	partial_ab = sum(r * (X + Y)) / s^2 - sum(r) * (Xcorner + Ycorner - u) / s^2 + l*Sum
	
	minindex = which(partial_ab > 0)[1]
	
	if (is.na(minindex)) {
		return(c(0,0))
	}
	
	aplusb = sum(r * (X + Y))/sum(r) + s^2*l*Sum[minindex]/sum(r) + u	
	
	if (minindex == 1) {
		min_a = Xcorner[minindex]
		max_a = aplusb - Ycorner[minindex]
		a = 0.5 * (min_a + max_a)
		b = aplusb - a
	} else if (Sum[minindex] != Sum[minindex-1]) {
		a = Xcorner[minindex]
		b = Ycorner[minindex]
	} else {
		min_a = max(Xcorner[minindex], aplusb - Ycorner[minindex-1])
		max_a = min(Xcorner[minindex-1], aplusb - Ycorner[minindex])
		a = 0.5 * (min_a + max_a)
		b = aplusb - a
	}
	
#	if (minindex > 1 && Sum[minindex] != Sum[minindex-1]) {
#		print("error")
#		return(c())
#	}
	
	
#	pac = sum(r * (X + Y)) / s^2 - sum(r) * (a + b - u) / s^2 + l*sum(r[X>a])
#	pbc = sum(r * (X + Y)) / s^2 - sum(r) * (a + b - u) / s^2 + l*sum(r[Y>b])
	
#	print(pac)
#	print(pbc)
	
	return(c(a,b))
}

pe_plot <- function(X, Y, B) {
	plot(X,Y,xlim=c(min(X)-100,max(X)+100),ylim=c(min(Y)-100,max(Y)+100))
	for (i in 1:dim(B)[1])
	{
		abline(v=B[i,1],col=i)
		abline(h=B[i,2],col=i)
		points(B[i,1],B[i,2],pch=2,col=i)
	}
}

pe_plot_cycle <- function(X, Y, B) {
	for (i in 1:dim(B)[1])
	{
		plot(X,Y,xlim=c(min(X)-100,max(X)+100),ylim=c(min(Y)-100,max(Y)+100))
		abline(v=B[i,1],col=i)
		abline(h=B[i,2],col=i)
		Sys.sleep(1)
	}
	
	pe_plot(X, Y, B)
}

pe_em <- function(X, Y, k, u, s, l) {
	if (k == 1) {
		B0 = cbind(X[1],Y[1])
	} else if (k == length(X)) {
		B0 = cbind(X,Y)
	} else {
		# Use KKZ to select k points
		D = cbind(X,Y)
		centers = matrix(D[which.max(X*Y),],1);
		for (i in 2:k) {
			sumsqs = c()
			for (j in 1:dim(centers)[1]) {
				diff = D - matrix(rep(centers[j,],each=length(X)),length(X))
				sumsq = rowSums(diff * diff)
				sumsqs = cbind(sumsqs,sumsq)
			}
			minOfRows = apply(sumsqs, 1, function(x) min(x))
			centers = rbind(centers,D[which.max(minOfRows),]);
		}
	
		# Guess breaks with kmeans
		km = kmeans(cbind(X,Y), centers, k)
		B0 = km$centers + u/2
	}
	
	# Guess even mix weights
	W0 = matrix(1, 1, dim(B0)[1]) / dim(B0)[1]
	
	# Assign initial parameters
	B1 = B0
	W1 = W0
	
	pe_plot(X,Y,B1)

	likelihoods = c()
	while (T) {
		likelihood = pe_likelihood(X, Y, B1, W1, u, s, l)
		
		# Check for converged clusters, else check for convergence
		if (length(likelihoods) > 0 && abs(likelihood - likelihoods[length(likelihoods)]) < tol) {
			break
		}
		
		if (length(likelihoods) > 1 && likelihood - likelihoods[length(likelihoods)] < -0.000001) {
			print("error")
			return(c())
		}
		
#		print(likelihood)
		
		# Output likelihood
		likelihoods = c(likelihoods,likelihood)
		
		# Calculate responsibilities (E Step)
		R1 = pe_resp(X, Y, B1, W1, u, s, l)
	
		# Find max likelihood breakpoints (M Step)
		B2 = c()
		for (i in 1:dim(B1)[1])
		{	
			B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
		}
		B1 = matrix(B2,k,2,byrow=T)
	
		# Find max likelihood mix weights (M Step)
		W1 = colSums(R1) / n
		
		pe_plot(X,Y,B1)
	}
	
#	R1[R1>0.1] = 1;
#	R1[R1<0.1] = 0;
#	print(R1)
	
	return(list(likelihood = likelihoods[length(likelihoods)], breaks = B1)) 
}



for (k in 1:min(10,length(X))) {
	estimate = pe_em(X, Y, k, u, s, l)
	print(k)
	print(-2 * estimate$likelihood + k * 2 * log(length(X)))
}




# Overestimate k
k0 = 3

# Use KKZ to select k points
D = cbind(X,Y)
centers = matrix(D[which.max(X*Y),],1);
for (i in 2:k0) {
	sumsqs = c()
	for (j in 1:dim(centers)[1]) {
		diff = D - matrix(rep(centers[j,],each=length(X)),length(X))
		sumsq = rowSums(diff * diff)
		sumsqs = cbind(sumsqs,sumsq)
	}
	minOfRows = apply(sumsqs, 1, function(x) min(x) )
	centers = rbind(centers,D[which.max(minOfRows),]);
}

# Guess breaks with kmeans
km = kmeans(cbind(X,Y), centers, k0)
B0 = km$centers + u/2

# Guess even mix weights
W0 = matrix(1, 1, dim(B0)[1]) / dim(B0)[1]

# Assign as initial parameters
B1 = B0
W1 = W0
k1 = k0

# Plot initial parameters
pe_plot(X,Y,B1)

Sys.sleep(1)

likelihoods = c()
while (T) {
	likelihood = pe_likelihood(X, Y, B1, W1, u, s, l)

	# Check for converged clusters, else check for convergence
 	if (length(likelihoods) > 0 && abs(likelihood - likelihoods[length(likelihoods)]) < tol) {
		break
	}
	
	# Output likelihood
	likelihoods = c(likelihoods,likelihood)
	
	# Calculate responsibilities (E Step)
	R1 = pe_resp(X, Y, B1, W1, u, s, l)

	# Find max likelihood breakpoints (M Step)
	B2 = c()
	for (i in 1:dim(B1)[1])
	{	
		B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
	}
	B1 = matrix(B2,k1,2,byrow=T)

	# Find max likelihood mix weights (M Step)
	W1 = colSums(R1) / n
	#W1 = max0(colSums(R1) - 1) / sum(max0(colSums(R1) - 1))
	
	# Delete dead clusters
	#B1 = B1[W1 > 0,]
	#W1 = W1[W1 > 0]
	#k1 = length(W1)

	# Plot iteration
	pe_plot(X,Y,B1)
	
	print(W1)

	Sys.sleep(1)
}

comp = 1; plot(X[R1[,comp] > 0.5],Y[R1[,comp] > 0.5])




pe_plot_cycle(X,Y,B1)


# Code for resetting clusters
	if (min(W1) < minW){
		print("fail")
		break
		for (i in which(W1 < minW)) {
			B1[i,] = runif(2,0,1000)
			W1[i] = 1 / length(W1)
		}
		W1 = W1 / sum(W1)
	} else



B1





B1 = array(c(800,300,600,100),c(2,2))
rowSums(R1 * t(Z))


Xcorner[minindex-1]
Ycorner[minindex-1]
Xcorner[minindex]
Ycorner[minindex]
partial_ab[minindex-1]
partial_ab[minindex]


partial_a = sum(r * (X + Y)) / s^2 - sum(r) * (a + b + u) / s^2 - l*sum(Xord[Xord[,1] < a,2])
partial_b = sum(r * (X + Y)) / s^2 - sum(r) * (a + b + u) / s^2 - l*sum(Xord[Yord[,1] < b,2])




sum(r * (X + Y)) / s^2 - sum(r) * (a + b + u) / s^2 - l*sum(Xord[Xord[,1] < a,2])
sum(r * (X + Y)) / s^2 - sum(r) * (a + b + u) / s^2 - l*sum(Xord[Yord[,1] < b,2])


pe_likelihood()



Sys.sleep(1)


pe_print <- function(X, Y) {
	cat(sprintf("int xlist[] = {"))
	for (i in 1:length(X)) {
		cat(sprintf("%d", X[i]))
		if (i != length(X)) {
			cat(sprintf(", ", X[i]))
		}
	}
	cat(sprintf("};\n"))

	cat(sprintf("int ylist[] = {"))
	for (i in 1:length(Y)) {
		cat(sprintf("%d", Y[i]))
		if (i != length(Y)) {
			cat(sprintf(", ", Y[i]))
		}
	}
	cat(sprintf("};\n"))
}


astart=-994002
aend=-993802
bstart=991115
bend=991315
avals=c()
bvals=c()
zvals=c()
for (aval in astart:aend)
{
	for (bval in bstart:bend)
	{
		zval = pe_resp_log_likelihood(X, Y, r, c(aval,bval), u, s, l)
		avals = c(avals, aval)
		bvals = c(bvals, bval)
		zvals = c(zvals, zval)
	}
}
zvals=matrix(zvals,nrow=length(astart:aend))
image(astart:aend,bstart:bend,zvals)


		# Calculate responsibilities (E Step)
		R1 = pe_resp(X, Y, B1, W1, u, s, l)
	
		# Find max likelihood breakpoints (M Step)
		B2 = c()
		for (i in 1:dim(B1)[1])
		{	
			B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
		}
		B1 = matrix(B2,k,2,byrow=T)
	
		# Find max likelihood mix weights (M Step)
		W1 = colSums(R1) / n
		
		pe_plot(X,Y,B1)
		pe_likelihood(X, Y, B1, W1, u, s, l)
		B1



X=c(40050676, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799, 40050799)
Y=c(2245, 2019, 2023, 2027, 2031, 2035, 2039, 2043, 2047, 2051, 2055, 2075, 2079, 2083, 2087)

X=c(-786, -786, -242, -242, -378, -606, -378, -606, -782, -782, -782, -351, -351, -351, -579, -579, -579, -807, -807, -807, -302, -530, -758, -302, -530, -758, -302, -530, -758, -327, -555, -783, -327, -555, -783, -327, -555, -783, -351, -351, -351, -579, -579, -579, -807, -807, -807, -544, -772, -544, -772, -544, -772)
Y=c(457, 685, 367, 595, 268, 268, 496, 496, 209, 437, 665, 239, 467, 695, 239, 467, 695, 239, 467, 695, 192, 192, 192, 420, 420, 420, 648, 648, 648, 242, 242, 242, 470, 470, 470, 698, 698, 698, 239, 467, 695, 239, 467, 695, 239, 467, 695, 206, 206, 434, 434, 662, 662)

<<<<<<< .mine

B1 = matrix(1:k*2,k,2,byrow=T)


B1[,1] =c(-960618, -993902, -972421, -988330, -987217)
B1[,2]=c(947790, 991215.408000000054016709327698, 975330, 985084.883333333302289247512817, 990028)
W1=c(0.10526315789473683626198408092, 0.657894736842105309904127352638, 0.0526315789473684181309920404601, 0.15789473684210525439297612138, 0.0263157894736842090654960202301)

pe_likelihood(X, Y, B1, W1, u, s, l)

# Calculate responsibilities (E Step)
R1 = pe_resp(X, Y, B1, W1, u, s, l)

# Find max likelihood breakpoints (M Step)
B2 = c()
for (i in 1:dim(B1)[1])
{	
	B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
}
B1 = matrix(B2,k,2,byrow=T)

# Find max likelihood mix weights (M Step)
W1 = colSums(R1) / n

pe_likelihood(X, Y, B1, W1, u, s, l)





R1[,1]=c(0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
R1[,2]=c(1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1)
R1[,3]=c(0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0)
R1[,4]=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0)
R1[,5]=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)

# Find max likelihood breakpoints (M Step)
B2 = c()
for (i in 1:dim(B1)[1])
{	
	B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
}
B1 = matrix(B2,k,2,byrow=T)

# Find max likelihood mix weights (M Step)
W1 = colSums(R1) / n

# Plot iteration
pe_plot(X,Y,B1)

pe_likelihood(X, Y, B1, W1, u, s, l)

# Calculate responsibilities (E Step)
R1 = pe_resp(X, Y, B1, W1, u, s, l)

# Find max likelihood breakpoints (M Step)
B2 = c()
for (i in 1:dim(B1)[1])
{	
	B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
}
B1 = matrix(B2,k,2,byrow=T)

# Find max likelihood mix weights (M Step)
W1 = colSums(R1) / n

pe_likelihood(X, Y, B1, W1, u, s, l)

# Plot iteration
pe_plot(X,Y,B1)
=======
X=c(-1662600, -1662600, -1622198, -1645763)
Y=c(68971268, 68989300, 68956194, 68955447)

X=c(-1804, -1804, -1811)
Y=c(159480110, 159480110, 159424643)

X=c(-5706, -2261, -2838, -3019)
Y=c(66180773, 66106373, 66181391, 66178043)

X=c(15124780, 15124826, 15108406, 15124811, 15124803, 15124828, 15124804, 15124815, 15105843, 15105843, 15111787, 15124795, 15105936, 15124791, 15105843, 15105843, 15107586, 15105843, 15105843, 15124803, 15124803, 15105843, 15105843, 15124783, 15108363, 15124827, 15124783, 15105927, 15124809, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15124811, 15124819, 15111797, 15107558, 15105927, 15124783, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15105843, 15124795, 15124802, 15111809, 15124815, 15111787, 15124804, 15124828, 15107586, 15107605, 15124795, 15124780, 15108363, 15124827, 15124780, 15105843, 15124795, 15124836)
Y=c(153, 117, 410, 130, 132, 110, 136, 129, 926, 983, 429, 153, 718, 157, 926, 983, 340, 926, 983, 132, 132, 929, 986, 151, 475, 103, 151, 719, 117, 920, 977, 1115, 1222, 1474, 1600, 1726, 1852, 1991, 2117, 130, 122, 424, 562, 719, 151, 919, 976, 926, 983, 1121, 1228, 1354, 1480, 1606, 1732, 1858, 1997, 2123, 153, 131, 400, 129, 429, 136, 110, 340, 501, 153, 153, 475, 103, 153, 992, 153, 101)

X=c(-993917, -972421, -960630, -993910, -993918, -994491, -993907, -993915, -993907, -960618, -993906, -993901, -988339, -960618, -987217, -993906, -993918, -993899, -993906, -988317, -993932, -993906, -993910, -993915, -993910, -960618, -993918, -994133, -993925, -991084, -988321, -972421, -991084, -988321, -993920, -993917, -993903, -993906)
Y=c(991037, 975193, 947665, 991035, 991049, 992004, 991035, 991036, 991035, 947653, 991036, 991043, 985018, 947653, 989891, 991036, 991034, 991026, 991036, 985599, 991054, 991036, 991026, 991035, 991035, 947653, 991035, 992071, 991035, 987200, 985012, 975193, 987200, 985012, 991039, 991035, 991039, 991036)

X=c(99743978, 99745364, 99746754, 99748144, 99749537, 99743868, 99745258, 99746644, 99748034, 99749424)
Y=c(102087034, 102087034, 102087034, 102087034, 102087034, 102088230, 102088230, 102088230, 102088230, 102088230)

X=c(-1930, -2062, -2049, -2544, -2104, -2554, -2052, -1928, -2065, -2542, -2050, -2540)
Y=c(-3229, -2424, -2411, -2329, -2339, -1356, -2414, -3227, -2427, -2327, -2412, -2325)

R1 = matrix(1:k*length(X),length(X),k,byrow=T)
R1[,1]=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 1)
R1[,2]=c(1, 0, 0, 0, 0, 1, 0, 0, 0, 0)
R1[,3]=c(0, 0, 0, 0, 0, 0, 0, 1, 0, 0)
R1[,4]=c(0, 0, 0, 1, 0, 0, 0, 0, 1, 0)
R1[,5]=c(0, 1, 0, 0, 0, 0, 1, 0, 0, 0)
R1[,6]=c(0, 0, 0, 0, 1, 0, 0, 0, 0, 0)
R1[,7]=c(0, 0, 1, 0, 0, 0, 0, 0, 0, 0)

		# Find max likelihood breakpoints (M Step)
		B2 = c()
		for (i in 1:dim(B1)[1])
		{	
			B2 = c(B2, pe_max_likelihood(X, Y, R1[,i], u, s, l))
		}
		B1 = matrix(B2,k,2,byrow=T)
	
		# Find max likelihood mix weights (M Step)
		W1 = colSums(R1) / n
		
		pe_plot(X,Y,B1)

		# Calculate responsibilities (E Step)
		R1 = pe_resp(X, Y, B1, W1, u, s, l)
	
		pe_max_likelihood(X, Y, R1[,4], u, s, l)
		r=R1[,4]
		
X=c(99743978, 99745364, 99746754, 99748144, 99749537, 99743868, 99745258, 99746644, 99748034, 99749424)
Y=c(102087034, 102087034, 102087034, 102087034, 102087034, 102088230, 102088230, 102088230, 102088230, 102088230)

X=c(0, 1386, 2776, 4166, 5559, -110, 1280, 2666, 4056, 5446)
Y=c(0,    0,    0,    0,    0, 1196, 1196, 1196, 1196, 1196)

X=c(-97532751, -97532751, -97532540, -97531889, -97532751, -97532461, -97531262, -97531390, -97532751, -97531572, -97532458, -97531924, -97531284, -97531253, -97531266)
Y=c(134886126, 134886125, 134885931, 134885223, 134886139, 134885858, 134884708, 134884828, 134886132, 134884944, 134885870, 134885273, 134884700, 134884691, 134884700)
u=233.917391619148
s=31.6295368373685
l=0.1

u = 233.917391619148
s = 31.6295368373685
l = 0.1

X=c(69529575, 69535159, 69539292, 69539208, 69533442, 69536859, 69533436, 69539370, 69534258, 69539265, 69539210, 69539282, 69535521, 69535120, 69535521, 69533440, 69534301, 69539337, 69539309, 69539309, 69539198, 69536363, 69539290, 69534699, 69530328, 69539323, 69533576, 69533563, 69539211, 69534370, 69535361, 69539373, 69535513, 69533588, 69539363, 69535835, 69539431, 69533589, 69539318, 69539272, 69539305, 69534298, 69539329, 69539319, 69535383, 69533435, 69533700, 69533604, 69533604, 69539251, 69539251, 69533617, 69539289, 69533589, 69533816, 69539275, 69539210, 69533515, 69536708, 69533538, 69533538, 69539304, 69539304, 69533619, 69535548, 69534218, 69539247, 69536691, 69539330, 69533614, 69539321, 69539423, 69539336, 69539850, 69539508, 69535521, 69539211, 69539788, 69535533, 69535419, 69539210, 69535445, 69539439, 69533436, 69539302, 69538764, 69533594, 69533528, 69535319, 69533506, 69533506, 69539291, 69539291, 69531208, 69535411, 69539514, 69534640, 69533545, 69533623, 69539325, 69539210, 69533575, 69539344, 69535378, 69535520, 69530668, 69539319, 69533581, 69539291, 69539634, 69539329, 69538694, 69539252, 69532382, 69539324, 69533569, 69533566, 69539296, 69534339, 69539193, 69530865, 69535538, 69531049, 69536860, 69538946, 69533577, 69539291, 69533526, 69533621, 69533435, 69535753, 69533563, 69539801, 69530627, 69538173, 69539381, 69534731, 69531746, 69535513, 69539448, 69533438, 69539298, 69539436, 69535602, 69539263, 69533539, 69533548, 69533933, 69533568, 69530845, 69533564, 69533562, 69533562, 69539251, 69539251, 69529920, 69539292, 69530339, 69535521, 69535137, 69539219, 69535803, 69535514, 69530291, 69539294, 69533598, 69533555, 69530291, 69539202, 69539323, 69533585, 69533621, 69535521, 69534382, 69539312, 69533610, 69539283, 69538705, 69533562, 69533562, 69539251, 69539251, 69533575, 69533583, 69534974, 69539301, 69539326, 69535660, 69536731, 69530843, 69535519, 69535324, 69539886, 69539370, 69539298, 69539266, 69539270, 69533520, 69533437, 69535645, 69533504, 69539875, 69535534, 69533437, 69539313, 69532287, 69539286, 69539258, 69533616, 69539421, 69539515, 69534442, 69539431, 69539326, 69539850, 69535570, 69539331, 69539330, 69533538, 69533554, 69533550, 69533550, 69539194, 69539194, 69539200, 69533546, 69539886, 69533588, 69534625, 69533615, 69533543, 69533550, 69533554, 69538417, 69535867, 69536470, 69539396, 69539319, 69532351, 69539392, 69539398, 69539406, 69539210, 69533538, 69538173, 69539384, 69533584, 69536534, 69538190, 69539210, 69533531, 69534154, 69533620, 69533618, 69533554, 69533578, 69539321, 69539875, 69539208, 69533436, 69539283, 69536411, 69533521, 69539310, 69530320, 69539210, 69539965, 69535375, 69533573, 69535379, 69535493, 69533428, 69535546, 69533614, 69533557, 69539292, 69538183, 69533584, 69539526, 69529681, 69533629, 69539858, 69533601, 69539873, 69533589, 69535370, 69533564, 69539303, 69539518, 69534362, 69534363, 69539327, 69533627, 69533592, 69539325, 69539209, 69533543, 69538137, 69539384, 69533550, 69534937, 69533438, 69533437, 69539668, 69535521, 69533407, 69535516, 69532453, 69533515, 69533568, 69533563, 69537185, 69533437, 69535518, 69533498, 69539380, 69539875, 69539280, 69535563, 69531575, 69534390, 69533437, 69535559, 69539209, 69539308, 69533609, 69534258, 69537248, 69533614, 69533614, 69539237, 69539237, 69533551, 69537181, 69539411)
Y=c(70529966, 70535544, 70539677, 70539593, 70533827, 70537249, 70533821, 70539755, 70534643, 70539650, 70539595, 70539667, 70535906, 70535505, 70535906, 70533825, 70534686, 70539722, 70539694, 70539694, 70539583, 70536753, 70539675, 70535084, 70530719, 70539708, 70533961, 70533948, 70539596, 70534755, 70535746, 70539758, 70535898, 70533973, 70539748, 70536220, 70539816, 70533974, 70539703, 70539657, 70539690, 70534683, 70539714, 70539704, 70535768, 70533820, 70534085, 70533989, 70539636, 70533989, 70539636, 70534002, 70539674, 70533974, 70534201, 70539660, 70539595, 70533900, 70537098, 70533923, 70539689, 70533923, 70539689, 70534004, 70535933, 70534603, 70539632, 70537081, 70539715, 70533999, 70539706, 70539808, 70539721, 70540219, 70539887, 70535906, 70539596, 70540167, 70535918, 70535804, 70539595, 70535830, 70539824, 70533821, 70539687, 70539153, 70533979, 70533913, 70535704, 70533891, 70539676, 70533891, 70539676, 70531594, 70535796, 70539893, 70535025, 70533930, 70534008, 70539710, 70539595, 70533960, 70539729, 70535763, 70535905, 70531056, 70539704, 70533966, 70539676, 70540013, 70539714, 70539083, 70539637, 70532767, 70539709, 70533954, 70533951, 70539681, 70534724, 70539578, 70531253, 70535923, 70531437, 70537250, 70539335, 70533962, 70539676, 70533911, 70534006, 70533820, 70536138, 70533948, 70540180, 70531015, 70538563, 70539766, 70535116, 70532132, 70535898, 70539833, 70533823, 70539683, 70539821, 70535987, 70539648, 70533924, 70533933, 70534318, 70533953, 70531233, 70533949, 70533947, 70539636, 70533947, 70539636, 70530311, 70539677, 70530730, 70535906, 70535522, 70539604, 70536188, 70535899, 70530682, 70539679, 70533983, 70533940, 70530682, 70539587, 70539708, 70533970, 70534006, 70535906, 70534767, 70539697, 70533995, 70539668, 70539094, 70533947, 70539636, 70533947, 70539636, 70533960, 70533968, 70535359, 70539686, 70539711, 70536045, 70537121, 70531231, 70535904, 70535709, 70540255, 70539755, 70539683, 70539651, 70539655, 70533905, 70533822, 70536030, 70533889, 70540244, 70535919, 70533822, 70539698, 70532672, 70539671, 70539643, 70534001, 70539806, 70539894, 70534827, 70539816, 70539711, 70540219, 70535955, 70539716, 70539715, 70533923, 70533939, 70533935, 70539579, 70533935, 70539579, 70539585, 70533931, 70540255, 70533973, 70535010, 70534000, 70533928, 70533935, 70533939, 70538807, 70536252, 70536860, 70539781, 70539704, 70532736, 70539777, 70539783, 70539791, 70539595, 70533923, 70538563, 70539769, 70533969, 70536924, 70538580, 70539595, 70533916, 70534539, 70534005, 70534003, 70533939, 70533963, 70539706, 70540244, 70539593, 70533821, 70539668, 70536801, 70533906, 70539695, 70530711, 70539595, 70540334, 70535760, 70533958, 70535764, 70535878, 70533813, 70535931, 70533999, 70533942, 70539677, 70538573, 70533969, 70539905, 70530072, 70534014, 70540227, 70533986, 70540242, 70533974, 70535755, 70533949, 70539688, 70539897, 70534747, 70534748, 70539712, 70534012, 70533977, 70539710, 70539594, 70533928, 70538527, 70539769, 70533935, 70535322, 70533823, 70533822, 70540047, 70535906, 70533792, 70535901, 70532838, 70533900, 70533953, 70533948, 70537575, 70533822, 70535903, 70533883, 70539765, 70540244, 70539665, 70535948, 70531961, 70534775, 70533822, 70535944, 70539594, 70539693, 70533994, 70534643, 70537638, 70533999, 70539622, 70533999, 70539622, 70533936, 70537571, 70539796)
u=233.917391619148
s=31.6295368373685
l=0.1


X=c(-204, -171, -171, -36, -160, -105, -1576, -47, -204, -44, -264, -203, -236, -202, -156, -1592, -180, -143, -257, -198, -154, -244, -204, -151, -119, -190, -262, -210, -257, -170, -218, -218, -255, -171, -245, -202, -81, -227, -195, -223, -148, -179, -182, -124, -193, -200, -423, -194, -149, -117, -156, -119, -223, -41, -245, -184, -256, -192, -195, -156, -136, -206, -194, -93, -162, -191, -197, -199, -200, -174, -152, -179, -131, -141, -204, -117, -173, -134, -188, -160, -202, -118, -256, -202, -198)
Y=c(73692827, 73692857, 73692857, 73694953, 73698616, 73696586, 73700303, 73694940, 73692825, 73694950, 73692857, 73692857, 73692857, 73692817, 73695035, 73692857, 73692853, 73692796, 73692860, 73692857, 73694467, 73692842, 73692827, 73695039, 73694973, 73692835, 73692864, 73692845, 73692860, 73692852, 73692862, 73692862, 73692857, 73692857, 73692857, 73698631, 73694920, 73692829, 73696769, 73698663, 73692759, 73692855, 73692857, 73698577, 73694476, 73692857, 73695112, 73692857, 73692815, 73695025, 73692817, 73695035, 73692845, 73694925, 73692857, 73692837, 73692864, 73692857, 73692857, 73692817, 73692857, 73692857, 73692857, 73694988, 73692857, 73692857, 73692865, 73692857, 73692857, 73692867, 73694450, 73692857, 73698569, 73692835, 73692827, 73695024, 73692835, 73695008, 73692861, 73698616, 73692845, 73692716, 73698646, 73692827, 73692857)
u=233.917391619148
s=31.6295368373685
l=0.1


